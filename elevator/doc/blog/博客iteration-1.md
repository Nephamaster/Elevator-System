# **结对项目-电梯调度**

by 何宇轩&李蕴文

[toc]

## **Ⅰ 问题假设**

    一幢 21 层的大厦，有 4 部电梯，乘客的体重：平均 70kg，最大 120kg，最小 40g）。
    其他的常量包括：电梯的速度，电梯门开关时间，乘客进出电梯的时间。
    大厦的楼层为-1，0，...，20，-1 层是地下停车场，1 层是大厅。以下是 4 部电梯的参数：

| 电梯编号 | 服务楼层        | 乘客人数限制 | 重量限制 |
| -------- | --------------- | ------------ | -------- |
| 1        | 所有楼层        | 10           | 800kg    |
| 2        | 1-10 层         | 10           | 800kg    |
| 3        | -1，1-10 层     | 20           | 1600kg   |
| 4        | -1，1，11-20 层 | 20           | 2000kg   |

## **Ⅱ PSP表格记录**

### **第 1 次迭代**

| Personal Software Process Stages        | 预估耗时（分钟） | 实际耗时（分钟） |
| --------------------------------------- | ---------------- | ---------------- |
| **计划**                                     | **90**                 | **50**                 |
| · 估计这个任务需要多少时间                | 30                 | 10                 |
| **开发**                                     | **1380**                 | **320**                 |
| · 需求分析 (包括学习新技术)               | 90                 | 60                 |
| · 生成设计文档                           | 120                 | 100                 |
| · 设计复审 (和同事审核设计文档)           | 60                 | 30                 |
| · 代码规范 (为目前的开发制定合适的规范)   | 30                 | 10                 |
| · 具体设计                              | 180                 | 120                 |
| · 具体编码                              | 480                 |                  |
| · 代码复审                              | 180                 |                  |
| · 测试（自我测试，修改代码，提交修改）    | 240                 |                  |
| **报告**                                    | **240**                 | **20**                 |
| · 测试报告                              | 180                 |                  |
| · 计算工作量                            | 30                 | 10                 |
| · 事后总结, 并提出过程改进计划           | 30                 | 10                 |
| **合计**                                    | **1710**                 | **400**                 |

    当前为第一次需求迭代，我们的工作还未涉及具体编码与测试等，因此与此相关的表项还未填写。通过对比可以发现实际工作时间普遍小于预估时间，我们认为可能是目前对于该项目工作量的估计有偏差；或需求分析和接口设计还不够全面细致、花费时间较少，后续会不断完善该部分工作。

## **Ⅲ 需求分析**

### **1 功能需求**

+ 乘客可以在每个楼层的电梯大厅**按下上行或下行按钮**来请求乘坐电梯。同时，乘客可以在电梯内部按下所需的楼层按钮来指定目标楼层。

+ 系统应根据**乘客的楼层请求**和**电梯的当前状态**来确定调用电梯的优先级。

+ 系统应考虑电梯的最大负荷能力，如果电梯已经满载或无法容纳新的乘客请求，系统应相应调整乘客的楼层请求或分配其他可用的电梯。

+ 在每个楼层的电梯大厅和电梯内部应设有电梯状态显示面板，以显示当前电梯运行、停止、开门、关门的状态和所在楼层。

+ 系统应根据乘客的请求和电梯的位置来确定**最佳响应时间**和**最短路径**。

### **2 性能需求**

+ **响应时间**：电梯调度系统应在乘客请求到达时快速响应。同时，系统应能够在短时间内计算出**最佳电梯分配方案**，优化电梯的运行轨迹和停留时间。

+ **吞吐量**：系统应能够处理多乘客的大量请求，要求支持**并行处理**多乘客请求，以提高整体吞吐量。

+ **可靠性**：系统应具备持续运行并处理乘客请求的能力，能够具有**故障检测**和**容错机制**，以保证系统在长期运行中的可靠性。

+ **界面友好性**：系统的UI界面需要简单美观，布局合理，功能完善，提供系统运行过程中必要的反馈信息，提供**快捷方式**和**回滚操作**，让新用户方便上手

### **3 可行性分析**

+ **技术可行性**

    采用运行高效的 **C++** 实现具体的编码，算法部分在 **Visual Studio Code** 中开发，UI界面采取 **QT** 开发框架进行开发，分别完成各自的**单元测试**后，最终集成到QT开发框架中，并进行**集成测试**。该框架产生的应用程序可以在 Windows 平台部署，并生成本地运行的项目文件。

+ **操作可行性**

    用户对电梯调度系统的操作易于理解和使用。用户界面的设计和交互方式能够确保用户能够方便地操作和理解电梯调度系统。

## **Ⅳ 模块设计与实现**

### **设计理念**

+ **信息隐藏**
  
  该项目至少会涉及乘客、电梯两大板块及其数据集合，因此我们采用 C++ 语言中**类的框架**对这些板块及其数据进行封装：每个类都有自己的**私有属性**，其他类不可访问；不同类之间的信息交换只能通过抽象接口进行。通过对类的合理设计，我们可以实现不同板块的信息隐藏，任何数据不会被不合时宜地访问和使用，使得程序中的数据集合有一定的**安全性保证**，确保程序能够**稳定运行**。

+ **接口设计**
  
  每个类都拥有若干接口，用于与其他类进行信息传递；在结对编程中，合作者可以通过调用接口比较轻松地部署程序结构和算法，编码中合作者交流比较方便。因此接口的设计必须保证**命名通俗易懂**、**参数类型明确**、**功能说明全面**等特性。

+ **松散耦合**
  
  耦合度指的是模块之间的联系紧密程度，耦合度越低模块间依赖度更低，模块独立性更强。在模块设计过程中，我们尽量降低模块之间的耦合度，避免模块间功能交错、难以理解和维护，最大程度降低一个模块结构的变化对其他模块的影响。具体地，我们设计的类之间仅有简单数据项传送的**数据耦合**、复杂数据结构传送的**特征耦合**以及极少量的**控制耦合**。

对于这三个理念应用的具体细节见下文。

### **STAGE 1 - 接口设计**

    设计一组可用于电梯调度的接口或类定义。主要考虑：
    · 简单
    · 如何提供足够的信息给调度器，以便于能顺利完成调度？
    · 实际驱动电梯的组件是什么？
    · 对何规定乘客的行为？例如当乘客需要从 3 层到 20 层时，但是当前电梯不能直达，乘客应如何行动？

为了满足程序功能结构 ***简单明确*** 的需求，我们最终只设计了三个类，并且尽量简化属性和接口：

**a. 乘客类 Passenger：**

+ **属性**：记录乘客的信息

+ **接口**：完成乘坐电梯全过程，***规定乘客行为***，当该部电梯不能到达目标楼层时则放弃呼叫，选择其他电梯。

**b. 电梯类 Elevator：**

+ **属性**：记录电梯的参数

+ **接口**：获取电梯各种属性、判断人数重量等是否超出限制、完成乘客运输过程。

**c. 调度器类 Controller：**

+ **接口**：实现电梯调度算法、监听乘客乘坐请求、呼叫电梯响应乘客请求。
